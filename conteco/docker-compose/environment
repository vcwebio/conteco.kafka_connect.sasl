#!/usr/bin/env bash

# START CONFIGURATION
DOLLAR='$'
export CONTECO_DC_GLOBAL_STACKS="kafka_connect.base"
export CONTECO_DC_GLOBAL_STACKNAMES="conteco_dc_kafka_connect"
export CONTECO_DC_GLOBAL_BOOTSTACKS="conteco_dc_kafka_connect"
export CONTECO_DC_GLOBAL_RUNSTACKS=""
export CONTECO_DC_GLOBAL_VOLUME_LIST="${DOLLAR}{CONTECO_STACKPREFIX}_kafka_connect_secrets_volume,${DOLLAR}{CONTECO_STACKPREFIX}_kafka_connect_connect_secrets_volume,${DOLLAR}{CONTECO_STACKPREFIX}_kafka_connect_data_volume,${DOLLAR}{CONTECO_STACKPREFIX}_kafka_connect_jars_volume"
# END CONFIGURATION

# START GLOBAL SETTINGS
export CONTECO_DC_GLOBAL='$CONTECO_DC_GLOBAL_SERVICE_NAME,$CONTECO_DC_GLOBAL_IMAGE_NAME,$CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT,$CONTECO_DC_KAFKA_CONNECT_COMMAND,$CONTECO_DC_KAFKA_CONNECT_VOLUMES,$CONTECO_DC_KAFKA_CONNECT_NETWORKS,$CONTECO_DC_KAFKA_CONNECT_DEPLOY_MODE,$CONTECO_DC_GLOBAL_VOLUMES,$CONTECO_DC_GLOBAL_NETWORKS'
export CONTECO_DC_GLOBAL_SERVICE_NAME="${CONTECO_TYPE}"
export CONTECO_DC_GLOBAL_IMAGE_NAME="${CONTECO_TYPE}.${CONTECO_NAME}:${CONTECO_TAG}"
export CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT="\
'CONNECT_REST_ADVERTISED_HOST_NAME=kafka_connect',\
'CONNECT_REST_PORT=8083',\
'CONNECT_GROUP_ID=kafka_connect',\
'CONNECT_CONFIG_STORAGE_TOPIC=kafka_connect_configs',\
'CONNECT_CONFIG_STORAGE_REPLICATION_FACTOR=3',\
'CONNECT_OFFSET_FLUSH_INTERVAL_MS=10000',\
'CONNECT_OFFSET_STORAGE_TOPIC=kafka_connect_offsets',\
'CONNECT_OFFSET_STORAGE_REPLICATION_FACTOR=3',\
'CONNECT_STATUS_STORAGE_TOPIC=kafka_connect_status',\
'CONNECT_STATUS_STORAGE_REPLICATION_FACTOR=3',\
'CONNECT_KEY_CONVERTER=org.apache.kafka.connect.storage.StringConverter',\
'CONNECT_VALUE_CONVERTER=io.confluent.connect.avro.AvroConverter',\
'CONNECT_VALUE_CONVERTER_SCHEMA_REGISTRY_URL=${DOLLAR}{CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_SCHEMA_REGISTRY_URL}',\
'CONNECT_VALUE_CONVERTER_BASIC_AUTH_CREDENTIALS_SOURCE=USER_INFO',\
'CONNECT_VALUE_CONVERTER_SCHEMA_REGISTRY_BASIC_AUTH_USER_INFO=${DOLLAR}{CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_SCHEMA_REGISTRY_API_KEY}:${DOLLAR}{CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_SCHEMA_REGISTRY_API_SECRET}',\
'CONNECT_INTERNAL_KEY_CONVERTER=org.apache.kafka.connect.json.JsonConverter',\
'CONNECT_INTERNAL_VALUE_CONVERTER=org.apache.kafka.connect.json.JsonConverter',\
'CONNECT_PRODUCER_CLASSPATH=/usr/share/java/monitoring-interceptors/monitoring-interceptors-5.4.0.jar',\
'CONNECT_PRODUCER_INTERCEPTOR_CLASSES=io.confluent.monitoring.clients.interceptor.MonitoringProducerInterceptor',\
'CONNECT_CONSUMER_INTERCEPTOR_CLASSES=io.confluent.monitoring.clients.interceptor.MonitoringConsumerInterceptor',\
'CONNECT_PLUGIN_PATH=/usr/share/java,/usr/share/confluent-hub-components',\
'CONNECT_LOG4J_LOGGERS=org.apache.zookeeper=ERROR,org.I0Itec.zkclient=ERROR,org.reflections=ERROR',\
'CONNECT_BOOTSTRAP_SERVERS=${DOLLAR}{CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_CLOUD_BOOTSTRAP_SERVERS}',\
'CONNECT_SSL_ENDPOINT_IDENTIFICATION_ALGORITHM=HTTPS',\
'CONNECT_SECURITY_PROTOCOL=SASL_SSL',\
'CONNECT_SASL_JAAS_CONFIG=org.apache.kafka.common.security.plain.PlainLoginModule required username=\"${DOLLAR}{CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_SASL_JAAS_CONFIG_CLUSTER_API_KEY}\" password=\"${DOLLAR}{CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_SASL_JAAS_CONFIG_CLUSTER_API_SECRET}\";',\
'CONNECT_SASL_MECHANISM=PLAIN',\
'CONNECT_PRODUCER_SECURITY_PROTOCOL=SASL_SSL',\
'CONNECT_PRODUCER_SASL_JAAS_CONFIG=org.apache.kafka.common.security.plain.PlainLoginModule required username=\"${DOLLAR}{CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_PRODUCER_SASL_JAAS_CONFIG_CLUSTER_API_KEY}\" password=\"${DOLLAR}{CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_PRODUCER_SASL_JAAS_CONFIG_CLUSTER_API_SECRET}\";',\
'CONNECT_PRODUCER_SASL_MECHANISM=PLAIN',\
'CONNECT_CONSUMER_SECURITY_PROTOCOL=SASL_SSL',\
'CONNECT_CONSUMER_SASL_JAAS_CONFIG=org.apache.kafka.common.security.plain.PlainLoginModule required username=\"${DOLLAR}{CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_CONSUMER_SASL_JAAS_CONFIG_CLUSTER_API_KEY}\" password=\"${DOLLAR}{CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_CONSUMER_SASL_JAAS_CONFIG_CLUSTER_API_SECRET}\";',\
'CONNECT_CONSUMER_SASL_MECHANISM=PLAIN'"
export CONTECO_DC_KAFKA_CONNECT_COMMAND=
export CONTECO_DC_KAFKA_CONNECT_VOLUMES="'${DOLLAR}{CONTECO_STACKPREFIX}_kafka_connect_connect_secrets_volume:/etc/kafka-connect/secrets','${DOLLAR}{CONTECO_STACKPREFIX}_kafka_connect_secrets_volume:/etc/kafka/secrets','${DOLLAR}{CONTECO_STACKPREFIX}_kafka_connect_data_volume:/var/lib/kafka/data','${DOLLAR}{CONTECO_STACKPREFIX}_kafka_connect_jars_volume:/etc/kafka-connect/jars'"
export CONTECO_DC_KAFKA_CONNECT_NETWORKS="${DOLLAR}{CONTECO_NETWORKLOCAL}_overlay"
export CONTECO_DC_KAFKA_CONNECT_DEPLOY_MODE="replicated"
export CONTECO_DC_GLOBAL_VOLUMES="${DOLLAR}{CONTECO_STACKPREFIX}_kafka_connect_connect_secrets_volume: { external: true },${DOLLAR}{CONTECO_STACKPREFIX}_kafka_connect_secrets_volume: { external: true },${DOLLAR}{CONTECO_STACKPREFIX}_kafka_connect_data_volume: { external: true },${DOLLAR}{CONTECO_STACKPREFIX}_kafka_connect_jars_volume: { external: true }"
export CONTECO_DC_GLOBAL_NETWORKS="${DOLLAR}{CONTECO_NETWORKLOCAL}_overlay: { external: true }"
# END GLOBAL SETTINGS


# START SETTINGS kafka_connect.base
#export CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_CLOUD_BOOTSTRAP_SERVERS=
#export CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_SASL_JAAS_CONFIG_CLUSTER_API_KEY=
#export CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_SASL_JAAS_CONFIG_CLUSTER_API_SECRET=
#export CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_SCHEMA_REGISTRY_URL=
#export CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_SCHEMA_REGISTRY_API_KEY=
#export CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_SCHEMA_REGISTRY_API_SECRET=
#export CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_PRODUCER_SASL_JAAS_CONFIG_CLUSTER_API_KEY=
#export CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_PRODUCER_SASL_JAAS_CONFIG_CLUSTER_API_SECRET=
#export CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_CONSUMER_SASL_JAAS_CONFIG_CLUSTER_API_KEY=
#export CONTECO_DC_KAFKA_CONNECT_ENVIRONMENT_CONNECT_CONSUMER_SASL_JAAS_CONFIG_CLUSTER_API_SECRET=
export CONTECO_DC_KAFKA_CONNECT_PORTS="8083:8083"
export CONTECO_DC_KAFKA_CONNECT_LABELS=
export CONTECO_DC_KAFKA_CONNECT_DEPLOY_LABELS=
export CONTECO_DC_KAFKA_CONNECT_DEPLOY_REPLICAS=1
export CONTECO_DC_KAFKA_CONNECT_DEPLOY_PLACEMENT_CONSTRAINTS=
export CONTECO_DC_KAFKA_CONNECT_DEPLOY_RESOURCES_LIMITS_CPUS=
export CONTECO_DC_KAFKA_CONNECT_DEPLOY_RESOURCES_RESERVATIONS_CPUS="0.1"
export CONTECO_DC_KAFKA_CONNECT_DEPLOY_RESOURCES_LIMITS_MEMORY="1536m"
export CONTECO_DC_KAFKA_CONNECT_DEPLOY_RESOURCES_RESERVATIONS_MEMORY="1024m"
# END SETTINGS kafka_connect.base

# START TOPLEVEL SETTINGS
# END TOPLEVEL SETTINGS
